<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META NAME="Generator" CONTENT="WebWriter/2 v1.2">
<TITLE>ASC documentation: The Source</TITLE>
	<LINK REL="stylesheet" TYPE="text/css" HREF="asc.css">
</HEAD>

<BODY text="#000000" bgcolor="#ffffff">

<CENTER>
<H1>Advanced Strategic Command</H1>
<P>documentation<P>
<H1>The Source</H1>
</CENTER>
I started writing the program and designed the basic game system in 1994 using Borland Pascal as the programming language. In 1995 I started using object orientated programming and in 1996 I converted the whole project to Watcom C/C++. We started the port to GCC and Linux in 1999. If you look at the source you will "see" this history. If I started such a project now from scratch I would design it completely different (for example a client / server design and everything much more object oriented). But we have the project as it is and are trying to improve it in that direction without rewriting it from scratch.<P>

The source code is not very well structured and documented. I always preferred writing cool new features instead of cleaning up the code :-) <BR>
We are going to improve this gradually. Don't hesitate to <A HREF="contact.html">contact us</A> if you have any questions regarding the source code or anything else about the game.<P>


Another "historical" thing about the source code is the language (not the programming language) that was used for it. Since we did not intend to release the source code we used a mixture of German and English for variable- and function names and avoided writing comments and those that we have are mostly in German. We have now run several translation passes through the code to translate it to English. The global interfaces should be completely in English now, but several local variables may still be in German. Since we run the translation through the code by a source code wide "search and replace" there are now some comments and perhaps a few code elements that were negatively affected by it and sound quite funny.<P>

<H2>Required Tools</H2>

<H3>for building the Windows version</H3>
We are building ASC/win with Borland C++ Builder 5. It should be possible to build ASC with any other Windows compiler too, if it has some sufficient understanding of the C++ language. Microsoft Visual C++ version 6 and older have not, it is absolutely impossible to compile ASC with these primitive compilers. But Visual Studio .NET is much improved and can compile ASC without any problems. The project files for Visual Studio .NET are included in the <tt>asc/source/win32/msvc</tt> directory, although they are not completed yet. But finishing them should be straight forward.

It is also possible to compile ASC with the free <A HREF="http://www.borland.com">Borland</A> command line compiler. Makefiles for it are included <P>

<H4>Borland C++ Builder / free command line compiler</H4>

<OL>
<LI>Get the <A HREF="http://www.asc-hq.org/library_package.zip">Library Package</A>.
<LI>If you downloaded the packaged sourcecode, the directory there is named <TT>asc-1.9.0</tt> or something similar. Rename to <tt>asc</tt>.
<li>Now uncompress the library package that its <tt>asc</tt> directory and the <tt>asc</tt> directory of the asc source overlap.

<H5>Borland C++ Builder</H5>
<OL start=4>
<LI>Open <TT>asc/Asc.bpg</TT> and run "make all projects"
<LI>If you want to run ASC from within Borland C++ Builder, place a file <TT>ASC.INI</TT> in <TT>asc\soure\win32\borland\</TT> that contains the following line: <BR>
<TT>SearchPath0=c:\somewhere\</TT><BR>
replace c:\somewhere by the directory where you want ASC to place its files (savegames, etc.).
<LI>Get the data files (<tt>main.con</tt> and others) from the <A HREF="http://www.asc-hq.org/download.html">website</A> and put it in this directory.
</OL>
<H5>Free Borland C++ command line compiler</H5>
<OL start=4>
<LI>Execute <TT>asc/makebcc.bat</TT> <P>

All major files will be placed in the <TT>asc\game\</TT> directory that is going to be created.
</OL>
</OL>

If you want to recreate the library package or use newer versions of the libraries, read the <A HREF="source_borland.html">detailed installation instructions</a>.

<H3>Microsoft Visual C++ 7.0</H3>

<H4>Environment variables </H4>
The VC++ 7.0 projects use some environment variables to get access to header and lib files not included with the sources of ASC. These variables are for now :
<TT>
<UL>
<LI>SDL
<LI>SDLmm
<LI>SDL_mixer
<LI>SDL_image
</UL>
</TT>

<p>
Set these variables to point to the directories where you installed SDL, SDLmm, SDL_mixer and SDL_image. The projects will search in the following directories to find the header and lib files : <br>

<TABLE border>
<tr>
  <th> Library name </th>
  <th> Include path </th>
  <th> library path </th>
</tr>

<tr>
 <td> <A HREF="http://www.libsdl.org">SDL</A> </TD>
 <td> $(SDL)/include </td>
 <td> $(SDL)/lib </td>
</tr>

<tr>
 <td> <A HREF="http://sdlmm.sf.net">SDLmm</A> </TD>
 <td> $(SDLmm)/src </td>
 <td> $(SDLmm)/lib </td>
</tr>

<tr>
 <td> <A HREF="http://www.libsdl.org/projects/SDL_mixer/index.html">SDL Mixer</A> </TD>
 <td> $(SDL_mixer) </td>
 <td> $(SDL_mixer)/lib </td>
</tr>

<tr>
 <td> <A HREF="http://www.libsdl.org/projects/SDL_image/index.html">SDL Image</A> </TD>
 <td> $(SDL_image) </td>
 <td> $(SDL_image)/lib </td>
</tr>
</TABLE>

<H4>How to compile:</H4>
Get the Jpeg library from the <A HREF="http://www.ijg.org/">Independent JPEG Group</A> and extract them into the <TT>games\asc\source\libs\jpeg-6b</TT> directory.
As soon as all your SDL stuff is ready and the environment variables are set, open the MSVC++ 7.0 solution <TT>games\asc\source\win32\msvc\asc-hq.sln</TT> in MSDev. In the "Solution Explorer", right clic on the project ASC and select "Build".

<H4>How to run ASC:</H4>
Grab the datafile ( main.con ) fom the website and put it in <TT>games\asc\source\Debug\bin</TT> and/or in <TT>games\asc\source\Release\bin </TT>( depending on the debug or release target you selected in MSDev to compile ASC ).
<p>
Double-click on asc.exe in <TT>games\asc\source\Debug\bin</TT> and/or in <TT>games\asc\source\Release\bin</TT> to start the game. Or you can just press CTRL-F5 in MSDev to start the game from the development environment.



<H3>for building the Linux version</H3>
Well, nothing special about that. We build ASC with the standard GNU development tools. Refer to INSTALL for (generic) build instructions.

<H3>Watcom C++</H3>

The discontinued DOS version and early Windows versions of ASC were built with Watcom C/C++ 11.0b. Since the compiler is dead and does not support all ANSI-C++ features, ASC can no longer be build with it.
Just in case that the <A HREF="http://www.openwatcom.org">OpenWatcom-Project</A> will bring the compiler up to date, we preserved the <A HREF="source_watcom.html">build instructions</A>.


<H2>Porting ASC</H2>
Porting ASC to any platform supported by SDL should be farely easy (as long as it is 32 bit and has Intel byte order).

<H2>The source documentation</H2>
The source documentation system used for ASC is <A HREF="http://www.stack.nl/~dimitri/doxygen/">doxygen</A>. The doxygen configuration file is <TT>asc/source/doxygen.config</TT>.



<H2>Source code formatting</H2>
Since there are many different source code formatting styles out there, it would be quite a mess if everybody used his own style and spends half his time undoing the formatting that others did. I don't want to force everybody to use exactly the same formatting, but if some source is <B>re</B>formatted, then to a well defined layout.
<A HREF="http://astyle.sourceforge.net/astyle/">Artistic Style</A> is a capable program for formatting source code.
The settings <TT>--style=linux -s3 -C -S</TT> are recommended to be used for ASC. If you write these settings to a file <TT>~/.astylerc</TT>, you don't need to type them each time you call Astyle. The central setting there is the -s3, which tells Astyle to indent with 3 spaces.<P>

<strong>Some nested and nasty #ifdefs can confuse Astyle. After using Astyle, check the last line of the source file and verify they are correctly indented. If they are not, either fix the #ifdef or restore to the backup file that was created by Astyle!</strong><P>

I personally don't like cutting breaking each line after 80 characters. The times when that was the upper limit of what a monitor could display at once are long passed. And since the first 120 characters (or whatever the size of your screen is) of a command are usually sufficient to get an idea what it is doing, I prefer to not have the next line cluttered with some coordinate calculations that nobody is really interested in.
But, as always, there are exceptions where it helps to break a command into several lines...
<P>


</BODY>
</HTML>
